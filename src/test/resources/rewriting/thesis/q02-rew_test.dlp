p1(x1, x4) :- s(x1, x2), r(x2, x3), p2(x3, x4).
p1(x1, x3) :- p2(x1, x2), p3(x2, x3).
p2(x1, x3) :- r(x1, x2), p3(x2, x3).
p3(x1, x3) :- s(x1, x2), r(x3, x2).